# ๐ STM32 ะัะพะตะบั - ะะพััะฝะตะฝะฝั ะดะปั ะฝะพะฒะฐัะบัะฒ

## ๐ฏ ะฉะพ ัะฐะบะต STM32?

**STM32** - ัะต ะผัะบัะพะบะพะฝััะพะปะตั (ะผะฐะปะตะฝัะบะธะน ะบะพะผะฟ'ััะตั ะฝะฐ ะพะดะฝัะน ะผัะบัะพััะตะผั) ะฒัะด ะบะพะผะฟะฐะฝัั STMicroelectronics.

### ะะฐัะฐ ะฟะปะฐัะฐ: BlackPill STM32F411CE

- **ะัะพัะตัะพั:** ARM Cortex-M4 @ 100 ะะั
- **RAM:** 128 ะะ (ะพะฟะตัะฐัะธะฒะฝะฐ ะฟะฐะผ'ััั)
- **Flash:** 512 ะะ (ะฟะฐะผ'ััั ะดะปั ะฟัะพะณัะฐะผะธ)
- **ะะฒะฐัั:** 25 ะะั (ะทะพะฒะฝััะฝัะน ะณะตะฝะตัะฐัะพั ัะฐะบัะพะฒะพั ัะฐััะพัะธ)

ะฆะต ัะบ Arduino, ะฐะปะต ะฝะฐะฑะฐะณะฐัะพ ะฟะพััะถะฝััะต ั ัะบะปะฐะดะฝััะต ะฒ ะฝะฐะปะฐัััะฒะฐะฝะฝั.

---

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัั PlatformIO

```
STM32_Core/
โโโ src/                           # ๐ ะะฐั ะฒะธััะดะฝะธะน ะบะพะด
โ   โโโ main.c                     # ะะพะปะพะฒะฝะฐ ะฟัะพะณัะฐะผะฐ
โ   โโโ main.h                     # ะะฐะณะพะปะพะฒะบะพะฒะธะน ัะฐะนะป ะดะปั main.c
โ   โโโ stm32f4xx_it.c             # ะะฑัะพะฑะฝะธะบะธ ะฟะตัะตัะธะฒะฐะฝั
โ   โโโ (ัะฝัั .c ัะฐะนะปะธ)
โ
โโโ include/                       # ๐ ะะฐะณะพะปะพะฒะบะพะฒั ัะฐะนะปะธ ะฟัะพะตะบัั
โ   โโโ stm32f4xx_hal_conf.h       # ะะพะฝััะณััะฐััั HAL ะฑัะฑะปัะพัะตะบะธ
โ   โโโ stm32f4xx_it.h             # ะะฐะณะพะปะพะฒะบะธ ะฟะตัะตัะธะฒะฐะฝั
โ   โโโ (ัะฝัั .h ัะฐะนะปะธ)
โ
โโโ lib/                           # ๐ ะะพะดะฐัะบะพะฒั ะฑัะฑะปัะพัะตะบะธ
โ   โโโ (ััั ะผะพะถะฝะฐ ะดะพะดะฐะฒะฐัะธ ัะฒะพั ะฑัะฑะปัะพัะตะบะธ)
โ
โโโ test/                          # ๐งช ะคะฐะนะปะธ ะดะปั ัะตัััะฒะฐะฝะฝั
โ
โโโ .pio/                          # โ๏ธ ะกะปัะถะฑะพะฒะฐ ะฟะฐะฟะบะฐ PlatformIO
โ   โโโ build/                     # ะกะบะพะผะฟัะปัะพะฒะฐะฝั ัะฐะนะปะธ (.o, .elf, .bin)
โ
โโโ platformio.ini                 # โ๏ธ ะะพะฝััะณััะฐััั ะฟัะพะตะบัั
โโโ learning/                      # ๐ ะะฐะฒัะฐะปัะฝั ะผะฐัะตััะฐะปะธ
    โโโ 01_project_structure.md    # ะฆะตะน ัะฐะนะป
```

### ะฉะพ ะดะต ะทะฑะตััะณะฐััััั

- **src/** - ะฒะตัั ะฒะฐั C/C++ ะบะพะด
- **include/** - ะทะฐะณะพะปะพะฒะบะพะฒั ัะฐะนะปะธ (.h)
- **lib/** - ััะพัะพะฝะฝั ะฑัะฑะปัะพัะตะบะธ
- **.pio/build/** - ัะตะทัะปััะฐั ะบะพะผะฟัะปัััั (ะฝะต ัะตะดะฐะณััะผะพ ะฒัััะฝั!)

---

## ๐ง ะฉะพ ัะฐะบะต HAL?

**HAL** = Hardware Abstraction Layer (ัะฐั ะฐะฑัััะฐะบััั ะฒัะด ะฐะฟะฐัะฐัะฝะพะณะพ ะทะฐะฑะตะทะฟะตัะตะฝะฝั)

ะฆะต ะฑัะฑะปัะพัะตะบะฐ ะฒัะด STMicroelectronics, ัะบะฐ ัะฟัะพััั ะฟัะพะณัะฐะผัะฒะฐะฝะฝั STM32.

### ๐ซ ะะตะท HAL (ัะบะปะฐะดะฝะพ)

```c
// ะขัะตะฑะฐ ะทะฝะฐัะธ ัะพัะฝั ะฐะดัะตัะธ ัะตะณัััััะฒ ะฟะฐะผ'ััั
#define RCC_BASE   0x40023800
#define GPIOC_BASE 0x40020800

*((uint32_t*)(RCC_BASE + 0x30)) |= 0x04;  // ะฃะฒัะผะบะฝััะธ GPIOC (GPIOC ัะพ ัะต 3-ัั ะฑััะพะฒะฐ ะฟะพะทะธััั)
*((uint32_t*)(GPIOC_BASE + 0x00)) |= (1 << 26); // ะัะฝ 13 ะฝะฐ ะฒะธััะด
*((uint32_t*)(GPIOC_BASE + 0x14)) ^= (1 << 13); // ะะตัะตะผะบะฝััะธ ะฟัะฝ 13
```

### โ ะ HAL (ะฟัะพััะพ ั ะทัะพะทัะผัะปะพ)

```c
__HAL_RCC_GPIOC_CLK_ENABLE();           // ะฃะฒัะผะบะฝััะธ ัะฐะบััะฒะฐะฝะฝั GPIOC
GPIO_InitTypeDef GPIO_InitStruct = {0};
GPIO_InitStruct.Pin = GPIO_PIN_13;
GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
HAL_GPIO_Init(GPIOC, &GPIO_InitStruct); // ะะฐะปะฐัััะฒะฐัะธ GPIO
HAL_GPIO_TogglePin(GPIOC, GPIO_PIN_13); // ะะตัะตะผะบะฝััะธ ะฟัะฝ
```

**ะะตัะตะฒะฐะณะธ HAL:**

- โ ะัะพััััะต ัะธัะฐัะธ ั ัะพะทัะผััะธ
- โ ะะตะฝัะต ะฟะพะผะธะปะพะบ
- โ ะะตะณะบะพ ะฟะตัะตะฝะพัะธัะธ ะบะพะด ะผัะถ STM32
- โ ะััััะนะฝะฐ ะฟัะดััะธะผะบะฐ ะฒัะด ST

---

## ๐ ะัะพะฑะปะตะผะฐ ัะฐ ัั ะฒะธัััะตะฝะฝั

### โ ะฉะพ ะฑัะปะพ ัะฟะพัะฐัะบั

```c
#include "main.h"  // โ ะคะฐะนะป ะฝะต ััะฝัั!

int main(void) {
    HAL_Init();    // โ ะะพะผะฟัะปััะพั ะฝะต ะทะฝะฐั ะทะฒัะดะบะธ ัั ััะฝะบััั
    ...
}
```

**ะะพะผะธะปะบะฐ ะบะพะผะฟัะปัััั:**

```
fatal error: main.h: No such file or directory
```

### ๐ ะัะธัะธะฝะธ ะฟะพะผะธะปะบะธ

1. ะคะฐะนะป `main.h` ะฝะต ััะฒะพัะตะฝะพ
2. ะะตะผะฐั ะฟัะดะบะปััะตะฝะฝั ะดะพ HAL ะฑัะฑะปัะพัะตะบะธ
3. ะะตะผะฐั ะบะพะฝััะณััะฐััั HAL (`stm32f4xx_hal_conf.h`)
4. ะะตะผะฐั ะพะฑัะพะฑะฝะธะบัะฒ ะฟะตัะตัะธะฒะฐะฝั

---

## ๐๏ธ ะััะตะฝะฝั: ะกัะฒะพัะตะฝั ัะฐะนะปะธ

### 1๏ธโฃ main.h - "ะะพะฒัะดะฝะธะบ" ะดะปั main.c

**ะะพะทัะฐััะฒะฐะฝะฝั:** `src/main.h`

```c
#ifndef __MAIN_H // ะะฐัะธัั ะฒัะด ะฟะพะดะฒัะนะฝะพะณะพ ะฒะบะปััะตะฝะฝั
#define __MAIN_H // __MAIN_H - ัะฝัะบะฐะปัะฝะธะน ัะดะตะฝัะธััะบะฐัะพั ะดะปั ััะพะณะพ ัะฐะนะปั

#ifdef __cplusplus // ะฏะบัะพ ะบะพะผะฟัะปััะพั C++, ะฒะธะบะพัะธััะพะฒััะผะพ C linkage ะดะปั ััะผััะฝะพััั ะท C ะบะพะดะพะผ
extern "C" { // ะะบะฐะทััะผะพ, ัะพ ััะฝะบััั ะผะฐััั C linkage (ะฝะต ะทะผัะฝัะฒะฐัะธ ัะผะตะฝะฐ ะฟัะธ ะบะพะผะฟัะปัััั)
#endif // ะฆะต ะฟะพัััะฑะฝะพ ะดะปั ััะผััะฝะพััั ะท C++ ะบะพะดะพะผ, ัะบัะพ ะฒะธ ะบะพะปะธ-ะฝะตะฑัะดั ะฑัะดะตัะต ะฒะธะบะพัะธััะพะฒัะฒะฐัะธ C++ ะฒ ััะพะผั ะฟัะพะตะบัั

#include "stm32f4xx_hal.h"  // ะัะดะบะปััะธัะธ HAL ะฑัะฑะปัะพัะตะบั

void Error_Handler(void);   // ะะณะพะปะพัะธัะธ ััะฝะบััั ะพะฑัะพะฑะบะธ ะฟะพะผะธะปะพะบ void ัะต ะพะทะฝะฐัะฐั, ัะพ ััะฝะบััั ะฝะต ะฟะพะฒะตััะฐั ะทะฝะฐัะตะฝะฝั

#ifdef __cplusplus // ะะฐะบัะธะฒะฐัะผะพ extern "C" ะฑะปะพะบ ะดะปั C++ ะบะพะผะฟัะปััะพัะฐ
}
#endif

#endif /* __MAIN_H */
```

**ะฉะพ ัะพะฑะธัั:**

- `#ifndef/__define` - ะทะฐัะธัั ะฒัะด ะฟะพะดะฒัะนะฝะพะณะพ ะฒะบะปััะตะฝะฝั
- `extern "C"` - ััะผััะฝัััั ะท C++
- ะัะดะบะปััะฐั ะฒัั HAL ะฑัะฑะปัะพัะตะบั STM32F4
- ะะณะพะปะพััั ััะฝะบััั `Error_Handler()`

---

### 2๏ธโฃ stm32f4xx_hal_conf.h - ะะพะฝััะณััะฐััั HAL

**ะะพะทัะฐััะฒะฐะฝะฝั:** `include/stm32f4xx_hal_conf.h`

```c
#define HAL_MODULE_ENABLED          // ะฃะฒัะผะบะฝััะธ HAL
#define HAL_GPIO_MODULE_ENABLED     // ะะพะดัะปั GPIO (ะฟัะฝะธ)
#define HAL_RCC_MODULE_ENABLED      // ะะพะดัะปั RCC (ัะฐะบััะฒะฐะฝะฝั)
#define HAL_PWR_MODULE_ENABLED      // ะะพะดัะปั PWR (ะถะธะฒะปะตะฝะฝั)
#define HAL_CORTEX_MODULE_ENABLED   // ะะพะดัะปั ะฟัะพัะตัะพัะฐ
#define HAL_DMA_MODULE_ENABLED      // ะะพะดัะปั DMA (ะฟััะผะธะน ะดะพัััะฟ ะดะพ ะฟะฐะผ'ััั)
#define HAL_FLASH_MODULE_ENABLED    // ะะพะดัะปั Flash ะฟะฐะผ'ััั

// ะงะฐััะพัะฐ ะทะพะฒะฝััะฝัะพะณะพ ะบะฒะฐััะฐ
#define HSE_VALUE    25000000U      // 25 ะะั ะฝะฐ BlackPill

// ะะฝัั ัะฐััะพัะธ
#define HSI_VALUE    16000000U      // ะะฝัััััะฝัะน RC ะณะตะฝะตัะฐัะพั
#define LSI_VALUE    32000U         // ะะธะทัะบะพัะฐััะพัะฝะธะน ะฒะฝัััััะฝัะน
#define LSE_VALUE    32768U         // ะะธะทัะบะพัะฐััะพัะฝะธะน ะทะพะฒะฝััะฝัะน
```

**ะะฐะฒััะพ:**

- HAL - ะดัะถะต ะฒะตะปะธะบะฐ ะฑัะฑะปัะพัะตะบะฐ (UART, SPI, I2C, ADC, USB...)
- ะขัั ะผะธ ะฒะธะฑะธัะฐัะผะพ ััะปัะบะธ ะฟะพัััะฑะฝั ะผะพะดัะปั
- ะฆะต ะฟัะธัะบะพััั ะบะพะผะฟัะปัััั ัะฐ ะทะผะตะฝััั ัะพะทะผัั ะฟัะพะณัะฐะผะธ

---

### 3๏ธโฃ stm32f4xx_it.c/.h - ะะฑัะพะฑะฝะธะบะธ ะฟะตัะตัะธะฒะฐะฝั

**ะะพะทัะฐััะฒะฐะฝะฝั:** `src/stm32f4xx_it.c` ัะฐ `include/stm32f4xx_it.h`

#### ะฉะพ ัะฐะบะต ะฟะตัะตัะธะฒะฐะฝะฝั (Interrupt)?

**ะะตัะตัะธะฒะฐะฝะฝั** - ัะต ะบะพะปะธ ัะพัั ัะตัะผัะฝะพะฒะพ ะฒัะดะฑัะฒะฐััััั ั ะฟัะพัะตัะพั ะทัะฟะธะฝัั ะพัะฝะพะฒะฝั ะฟัะพะณัะฐะผั:

```diagram
ะัะฝะพะฒะฝะฐ ะฟัะพะณัะฐะผะฐ โ ะะะะะะะะะะะฏ! โ ะะฑัะพะฑะฝะธะบ โ ะะพะฒะตัะฝะตะฝะฝั ะดะพ ะฟัะพะณัะฐะผะธ
     โ                  โ              โ
     โ                  โ              โ
     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ะัะธะบะปะฐะดะธ:**

- โฐ ะขะฐะนะผะตั ัะฟัะฐััะฒะฐะฒ โ `SysTick_Handler()`
- ๐ด ะะฝะพะฟะบะฐ ะฝะฐัะธัะฝััะฐ โ `EXTI0_IRQHandler()`
- ๐ก ะัะธะนัะปะธ ะดะฐะฝั UART โ `USART1_IRQHandler()`
- ๐ฅ ะัะธัะธัะฝะฐ ะฟะพะผะธะปะบะฐ โ `HardFault_Handler()`

#### ะะฑะพะฒ'ัะทะบะพะฒั ะพะฑัะพะฑะฝะธะบะธ ARM Cortex-M4

ARM Cortex-M4 ัะต ะผัะฝัะผะฐะปัะฝะธะน ะฝะฐะฑัั ะพะฑัะพะฑะฝะธะบัะฒ, ัะบั ะฟะพะฒะธะฝะฝั ะฑััะธ ะฒะธะทะฝะฐัะตะฝั ะฒ ะฟัะพะตะบัั. ะะฐะฒััั ัะบัะพ ะฒะธ ะฝะต ะฒะธะบะพัะธััะพะฒัััะต ะฒัั ัั ะฟะตัะตัะธะฒะฐะฝะฝั, ะฒะพะฝะธ ะฟะพะฒะธะฝะฝั ะฑััะธ ะฟัะธัััะฝัะผะธ, ัะฝะฐะบัะต ะบะพะผะฟัะปััะพั ะฒะธะดะฐััั ะฟะพะผะธะปะบั.

```c
void SysTick_Handler(void) {
    HAL_IncTick();  // ะะพะถะฝั 1 ะผั ะทะฑัะปัััั ะปััะธะปัะฝะธะบ
                    // ะะพัััะฑะฝะพ ะดะปั HAL_Delay()
}

void HardFault_Handler(void) {
    while (1) {}    // ะัะธัะธัะฝะฐ ะฟะพะผะธะปะบะฐ - ะทะฐะฒะธัะฐะฝะฝั
}

void NMI_Handler(void) {}           // Non-Maskable Interrupt
void MemManage_Handler(void) {}     // ะะพะผะธะปะบะฐ ะดะพัััะฟั ะดะพ ะฟะฐะผ'ััั
void BusFault_Handler(void) {}      // ะะพะผะธะปะบะฐ ัะธะฝะธ ะดะฐะฝะธั
void UsageFault_Handler(void) {}    // ะะพะผะธะปะบะฐ ะฒะธะบะพะฝะฐะฝะฝั ัะฝััััะบััั
void SVC_Handler(void) {}           // Supervisor Call (RTOS)
void DebugMon_Handler(void) {}      // Debug Monitor
void PendSV_Handler(void) {}        // Pendable Service (RTOS)
```

**ะะตะท ัะธั ะพะฑัะพะฑะฝะธะบัะฒ ะฟัะพะตะบั ะฝะต ัะบะพะผะฟัะปัััััั!**

---

### 4๏ธโฃ SystemClock_Config() - ะะฐะปะฐัััะฒะฐะฝะฝั ัะฐััะพัะธ

**ะะพะทัะฐััะฒะฐะฝะฝั:** `src/main.c`

#### ะะฐะฒััะพ ะฟะพัััะฑะฝะพ?

ะะฐ ะทะฐะผะพะฒััะฒะฐะฝะฝัะผ STM32F411 ะฟัะฐััั ะฝะฐ **16 ะะั** (ะฒะฝัััััะฝัะน RC ะณะตะฝะตัะฐัะพั HSI).
ะะปะต ะฒัะฝ ะทะดะฐัะฝะธะน ะฝะฐ **100 ะะั**! ะะฐะผ ะฟะพัััะฑะฝะพ ะนะพะณะพ "ัะพะทัะณะฝะฐัะธ".

ะฝะฐัะพ ัะต ะฟะพัััะฑะฝะพ?
ะงะธะผ ะฒะธัะฐ ัะฐััะพัะฐ, ัะธะผ ัะฒะธะดัะต ะฟัะฐััั ะฟัะพัะตัะพั ั ะฟะตัะธัะตััั. ะะปะต ัะต ัะฐะบะพะถ ะทะฑัะปัััั ัะฟะพะถะธะฒะฐะฝะฝั ะตะฝะตัะณัั.

#### ะฏะบ ัะต ะฟัะฐััั

```diagram
[ะะฒะฐัั 25 ะะั] โ [PLL ะผะฝะพะถะฝะธะบ] โ [ะัะปะธะปัะฝะธะบะธ] โ [96 ะะั ะฟัะพัะตัะพั]
                                              โ
                                         [48 ะะั APB1]
                                         [96 ะะั APB2]
```

#### ะคะพัะผัะปะฐ PLL (Phase-Locked Loop) ะดะปั ะพะฑัะธัะปะตะฝะฝั ัะฐััะพัะธ ะฟัะพัะตัะพัะฐ

```formula
f_CPU = (HSE_VALUE / PLLM) ร PLLN / PLLP

f_CPU = (25 ะะั / 25) ร 192 / 2 = 96 ะะั
```

**ะะฐัะฐะผะตััะธ:**

- `PLLM = 25` - ะดัะปะธะผะพ ะบะฒะฐัั: 25 ะะั / 25 = 1 ะะั (PLL - ัะต ัะบ "ะฟะพัะตัะตะดะฝะธะบ" ะผัะถ ะบะฒะฐััะพะผ ั ะฟัะพัะตัะพัะพะผ - ะฒัะฝ ะดะพะทะฒะพะปัั ะฝะฐะผ ะพััะธะผะฐัะธ ะฟะพัััะฑะฝั ัะฐััะพัั ะทะฐ ะดะพะฟะพะผะพะณะพั ะผะฝะพะถะฝะธะบัะฒ ั ะดัะปะธะปัะฝะธะบัะฒ)
- `PLLN = 192` - ะผะฝะพะถะธะผะพ: 1 ะะั ร 192 = 192 ะะั
- `PLLP = 2` - ะดัะปะธะผะพ: 192 ะะั / 2 = **96 ะะั** ๐ฏ
- `PLLQ = 4` - ะดะปั USB: 192 ะะั / 4 = 48 ะะั

ะะฑััะฒัะฐัััะฐ:

- `HSE` - High-Speed External (ะทะพะฒะฝััะฝัะน ะบะฒะฐัั)
- `HSI` - High-Speed Internal (ะฒะฝัััััะฝัะน RC ะณะตะฝะตัะฐัะพั)
- `PLL` - Phase-Locked Loop (ะผะฝะพะถะฝะธะบ ัะฐััะพัะธ)
- `PLLM` - PLL M (ะดัะปะธะปัะฝะธะบ ะดะปั ะฒัะพะดั ะฒ PLL)
- `PLLN` - PLL N (ะผะฝะพะถะฝะธะบ ะดะปั PLL)
- `PLLP` - PLL P (ะดัะปะธะปัะฝะธะบ ะดะปั ะฟัะพัะตัะพัะฐ)
- `PLLQ` - PLL Q (ะดัะปะธะปัะฝะธะบ ะดะปั USB)

#### ะจะธะฝะธ ะฟัะพัะตัะพัะฐ

```diagram
SYSCLK (96 ะะั) โ ะัะพัะตัะพั, Flash
    โ
AHB (96 ะะั)    โ DMA, GPIO, ัะพัะพ
    โ
APB1 (48 ะะั)   โ UART, I2C, ัะฐะนะผะตัะธ (ะฟะพะฒัะปัะฝั ะฟะตัะธัะตััะนะฝั ะฟัะธัััะพั)
APB2 (96 ะะั)   โ SPI, ADC (ัะฒะธะดะบั ะฟะตัะธัะตััะนะฝั ะฟัะธัััะพั)
```

**ะงะพะผั APB1 ะฟะพะฒัะปัะฝััะต?**
ะะตัะบั ะผะพะดัะปั ะฝะต ะฟัะฐััััั ะฝะฐ 96 ะะั, ัะพะผั ัั ะพะฑะผะตะถัััั ะดะพ 48 ะะั.

---

### 5๏ธโฃ Error_Handler() - ะะฑัะพะฑะบะฐ ะฟะพะผะธะปะพะบ

**ะะพะทัะฐััะฒะฐะฝะฝั:** `src/main.c`

```c
void Error_Handler(void)
{
    __disable_irq();  // ะะธะผะบะฝััะธ ะฒัั ะฟะตัะตัะธะฒะฐะฝะฝั
    while (1)         // ะะฐะฒะธัะฝััะธ ะฒ ะฝะตัะบัะฝัะตะฝะฝะพะผั ัะธะบะปั
    {
        // ะขัั ะผะพะถะฝะฐ ะดะพะดะฐัะธ ะผะธะณะฐะฝะฝั LED ะดะปั ัะฝะดะธะบะฐััั ะฟะพะผะธะปะบะธ
    }
}
```

**ะะพะปะธ ะฒะธะบะปะธะบะฐััััั:**

- ะะพะผะธะปะบะฐ ะฝะฐะปะฐัััะฒะฐะฝะฝั ัะฐะบััะฒะฐะฝะฝั
- ะะพะผะธะปะบะฐ ัะฝัััะฐะปัะทะฐััั ะฟะตัะธัะตััั
- ะัะดั-ัะบะฐ ะบัะธัะธัะฝะฐ ะฟะพะผะธะปะบะฐ

**ะฉะพ ัะพะฑะธัะธ ะฟัะธ ะฟะพะผะธะปัั:**

1. ะัะดะบัะธัะธ Debug ัะตะถะธะผ
2. ะะพะดะธะฒะธัะธัั ะดะต ะฟัะพะณัะฐะผะฐ ะทะฐะฒะธัะปะฐ
3. ะะตัะตะฒััะธัะธ ะฝะฐะปะฐัััะฒะฐะฝะฝั (ัะฐััะพัะธ, ะฟัะฝะธ, ัะพัะพ)

---

## ๐ ะะพะทะฑัั main.c

### ะะพะฒะฝะธะน ะบะพะด ะท ะบะพะผะตะฝัะฐััะผะธ

```c
#include "main.h"  // ะัะดะบะปััะธัะธ HAL ัะฐ ะพะณะพะปะพัะตะฝะฝั

void SystemClock_Config(void);  // ะัะพัะพัะธะฟ ััะฝะบััั

int main(void)
{
    // 1๏ธโฃ ะะฝัััะฐะปัะทะฐััั HAL (ะฝะฐะปะฐัััะฒะฐะฝะฝั SysTick, Flash, ัะพัะพ)
    HAL_Init();

    // 2๏ธโฃ ะะฐะปะฐัััะฒะฐะฝะฝั ัะฐััะพัะธ ะฟัะพัะตัะพัะฐ (16 ะะั โ 96 ะะั)
    SystemClock_Config();

    // 3๏ธโฃ ะฃะฒัะผะบะฝััะธ ัะฐะบััะฒะฐะฝะฝั GPIO Port C
    __HAL_RCC_GPIOC_CLK_ENABLE();

    // 4๏ธโฃ ะะฐะปะฐัััะฒะฐัะธ ะฟัะฝ PC13 (ะฒะฑัะดะพะฒะฐะฝะธะน LED ะฝะฐ BlackPill)
    // ะกัััะบัััะฐ ะดะปั ะฝะฐะปะฐัััะฒะฐะฝะฝั GPIO
    // GPIO_InitTypeDef - ัะต ััััะบัััะฐ, ัะบะฐ ะผัััะธัั ะฒัั ะฝะฐะปะฐัััะฒะฐะฝะฝั ะดะปั ะพะดะฝะพะณะพ ะฐะฑะพ ะดะตะบัะปัะบะพั GPIO ะฟัะฝัะฒ. ะะพะฝะฐ ะฒะธะทะฝะฐัะตะฝะฐ ะฒ HAL ะฑัะฑะปัะพัะตัั ั ะฒะธะบะพัะธััะพะฒัััััั ะดะปั ะบะพะฝััะณััะฐััั ัะตะถะธะผั ัะพะฑะพัะธ, ะฟัะดััะถะบะธ ัะฐ ัะฒะธะดะบะพััั ะฟะตัะตะผะธะบะฐะฝะฝั ะฟัะฝะฐ.
    // GPIO_InitStruct - ัะต ะทะผัะฝะฝะฐ ัะธะฟั GPIO_InitTypeDef, ัะบะฐ ะฑัะดะต ะทะฐะฟะพะฒะฝะตะฝะฐ ะฝะตะพะฑััะดะฝะธะผะธ ะฝะฐะปะฐัััะฒะฐะฝะฝัะผะธ ะดะปั ะบะพะฝะบัะตัะฝะพะณะพ ะฟัะฝะฐ (ะฒ ะดะฐะฝะพะผั ะฒะธะฟะฐะดะบั PC13) ั ะฟะตัะตะดะฐะฝะฐ ััะฝะบััั HAL_GPIO_Init() ะดะปั ะทะฐััะพััะฒะฐะฝะฝั ัะธั ะฝะฐะปะฐัััะฒะฐะฝั ะดะพ ะฒัะดะฟะพะฒัะดะฝะพะณะพ GPIO ะฟะพััั.

    GPIO_InitTypeDef GPIO_InitStruct = {0};  // ะกัััะบัััะฐ ะฝะฐะปะฐัััะฒะฐะฝั
    GPIO_InitStruct.Pin = GPIO_PIN_13;       // ะัะฝ 13
    GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP; // ะะตะถะธะผ: ะฒะธััะด Push-Pull
    GPIO_InitStruct.Pull = GPIO_NOPULL;      // ะะตะท ะฟัะดััะถะบะธ (ะฝะต ะฟัะดััะณััะผะพ ะดะพ +3.3V ั ะฝะต ะฟัะดััะณััะผะพ ะดะพ GND)
    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW; // ะะธะทัะบะฐ ัะฒะธะดะบัััั (ะดะพ 8 ะะั, ะดะพััะฐัะฝัะพ ะดะปั LED)
    HAL_GPIO_Init(GPIOC, &GPIO_InitStruct);  // ะะฐััะพััะฒะฐัะธ ะฝะฐะปะฐัััะฒะฐะฝะฝั (GPIOC - ะฟะพัั, &GPIO_InitStruct - ะฒะบะฐะทัะฒะฝะธะบ ะฝะฐ ััััะบัััั ะฝะฐะปะฐัััะฒะฐะฝั)

    // 5๏ธโฃ ะะพะปะพะฒะฝะธะน ัะธะบะป (ะฒะธะบะพะฝัััััั ะฑะตะทะบัะฝะตัะฝะพ)
    while (1)
    {
        HAL_GPIO_TogglePin(GPIOC, GPIO_PIN_13); // ะะตัะตะผะบะฝััะธ LED
        HAL_Delay(500);                         // ะะฐััะธะผะบะฐ 500 ะผั
    }
}
```

### ะะพััะฝะตะฝะฝั ััะดะพะบ ะทะฐ ััะดะบะพะผ

#### `HAL_Init()`

- ะะฝัััะฐะปัะทัั HAL ะฑัะฑะปัะพัะตะบั
- ะะฐะปะฐััะพะฒัั SysTick ัะฐะนะผะตั (1 ะผั)
- ะะฐะปะฐััะพะฒัั Flash ะฟะฐะผ'ััั
- **ะะฑะพะฒ'ัะทะบะพะฒะพ ะฒะธะบะปะธะบะฐัะธ ะฟะตััะพั!**

#### `SystemClock_Config()`

- ะะฐะปะฐััะพะฒัั PLL (Phase-Locked Loop)
- ะะตัะตะบะปััะฐั ะฟัะพัะตัะพั ะท HSI (16 ะะั) ะฝะฐ PLL (96 ะะั)
- ะะฐะปะฐััะพะฒัั ะดัะปะธะปัะฝะธะบะธ ัะธะฝ (AHB, APB1, APB2)

#### `__HAL_RCC_GPIOC_CLK_ENABLE()`

- **RCC** = Reset and Clock Control (ะบะพะฝััะพะปะตั ัะฐะบััะฒะฐะฝะฝั)
- ะฃะฒัะผะบะฝััะธ ัะฐะบััะฒะฐะฝะฝั ะดะปั GPIO Port C
- **ะะตะท ััะพะณะพ GPIO ะฝะต ะฟัะฐััั!** (ะตะบะพะฝะพะผัั ะตะฝะตัะณัั)

#### `GPIO_InitTypeDef`

ะกัััะบัััะฐ ะท ะฝะฐะปะฐัััะฒะฐะฝะฝัะผะธ GPIO:

- `Pin` - ัะบะธะน ะฟัะฝ (0-15)
- `Mode` - ัะตะถะธะผ ัะพะฑะพัะธ:
  - `GPIO_MODE_INPUT` - ะฒััะด
  - `GPIO_MODE_OUTPUT_PP` - ะฒะธััะด Push-Pull
  - `GPIO_MODE_OUTPUT_OD` - ะฒะธััะด Open-Drain
  - `GPIO_MODE_AF_PP` - ะฐะปััะตัะฝะฐัะธะฒะฝะฐ ััะฝะบััั
- `Pull` - ะฟัะดััะถะบะฐ:
  - `GPIO_NOPULL` - ะฑะตะท ะฟัะดััะถะบะธ
  - `GPIO_PULLUP` - ะดะพ +3.3V
  - `GPIO_PULLDOWN` - ะดะพ GND
- `Speed` - ัะฒะธะดะบัััั ะฟะตัะตะผะธะบะฐะฝะฝั:
  - `GPIO_SPEED_FREQ_LOW` - ะดะพ 8 ะะั
  - `GPIO_SPEED_FREQ_MEDIUM` - ะดะพ 50 ะะั
  - `GPIO_SPEED_FREQ_HIGH` - ะดะพ 100 ะะั

#### `HAL_GPIO_TogglePin()`

- ะะตัะตะผะธะบะฐั ััะฐะฝ ะฟัะฝะฐ (0 โ 1 ะฐะฑะพ 1 โ 0)
- ะะปั LED: ัะฒัะผะบะฝััะธ โ ะฒะธะผะบะฝััะธ

#### `HAL_Delay(500)`

- ะะฐััะธะผะบะฐ 500 ะผัะปััะตะบัะฝะด
- ะะธะบะพัะธััะพะฒัั SysTick ัะฐะนะผะตั
- **ะะต ัะพัะฝะฐ!** (ะดะปั ัะพัะฝะธั ะทะฐััะธะผะพะบ ะฒะธะบะพัะธััะพะฒัะนัะต ัะฐะนะผะตัะธ)
- ะัะด ัะฐั ะทะฐััะธะผะบะธ ะฟัะพัะตัะพั ะฝะต ะฒะธะบะพะฝัั ัะฝัั ะทะฐะฒะดะฐะฝะฝั (ะฑะปะพะบัััะฐ ะทะฐััะธะผะบะฐ)
- ะะปั ัะตัะนะพะทะฝะธั ะฟัะพะตะบััะฒ ะบัะฐัะต ะฒะธะบะพัะธััะพะฒัะฒะฐัะธ ัะฐะนะผะตัะธ ะฐะฑะพ RTOS ะดะปั ะฝะตะฑะปะพะบัััะธั ะทะฐััะธะผะพะบ

---

## ๐ ะัะพัะตั ะบะพะผะฟัะปัััั

### ะัะฐะฟะธ ะทะฑััะบะธ ะฟัะพะตะบัั

```diagram
1๏ธโฃ ะัะตะฟัะพัะตัะพั (Preprocessor)
   main.c โ ะะฑัะพะฑะบะฐ #include, #define โ main.i

2๏ธโฃ ะะพะผะฟัะปััะพั (Compiler)
   main.i โ ะะตัะตะฒััะบะฐ ัะธะฝัะฐะบัะธัั โ main.s (ะฐัะตะผะฑะปะตั)

3๏ธโฃ ะัะตะผะฑะปะตั (Assembler)
   main.s โ ะะฐัะธะฝะฝะธะน ะบะพะด โ main.o (ะพะฑ'ัะบัะฝะธะน ัะฐะนะป)

4๏ธโฃ ะัะฝะบะตั (Linker)
   main.o + stm32f4xx_it.o + HAL_lib โ firmware.elf

5๏ธโฃ ะะพะฝะฒะตััะตั (Objcopy)
   firmware.elf โ firmware.bin (ัะฐะนะป ะดะปั ะฟัะพัะธะฒะบะธ)
```

### ะะตะทัะปััะฐั ะทะฑััะบะธ

```
Building .pio/build/blackpill_f411ce/firmware.bin
RAM:   [          ]   0.0% (used 44 bytes from 131072 bytes)
Flash: [          ]   0.7% (used 3424 bytes from 524288 bytes)
========================= [SUCCESS] =========================
```

**ะฉะพ ะพะทะฝะฐัะฐััั ัะธััะธ:**

- **RAM 44 bytes** - ะทะผัะฝะฝั ะฒ ะฟะฐะผ'ััั (ะดัะถะต ะผะฐะปะพ!)
- **Flash 3424 bytes** - ัะพะทะผัั ะฟัะพะณัะฐะผะธ (~3.3 ะะ)
- ะฉะต ะผะฐัะผะพ **508 ะะ** ะฒัะปัะฝะพะณะพ ะผัััั! ๐

---

## ๐ ะะพะดะฐะปััะต ะฝะฐะฒัะฐะฝะฝั

### 1. ะัะฝะพะฒะธ C

- [ ] ะะผัะฝะฝั ัะฐ ัะธะฟะธ ะดะฐะฝะธั
- [ ] ะคัะฝะบััั
- [ ] ะะพะบะฐะถัะธะบะธ (pointer)
- [ ] ะกัััะบัััะธ (struct)
- [ ] ะัะตะฟัะพัะตัะพั (#include, #define, #ifdef)

### 2. ะัะฝะพะฒะธ STM32

- [ ] ะััััะตะบัััะฐ ARM Cortex-M4
- [ ] ะกะธััะตะผะฐ ัะฐะบััะฒะฐะฝะฝั (RCC)
- [ ] GPIO (ะฟัะฝะธ ะฒะฒะพะดั/ะฒะธะฒะพะดั)
- [ ] ะะตัะตัะธะฒะฐะฝะฝั (NVIC)
- [ ] ะขะฐะนะผะตัะธ
- [ ] UART (ะฟะพัะปัะดะพะฒะฝะธะน ะฟะพัั)

### 3. HAL ะฑัะฑะปัะพัะตะบะฐ

- [ ] ะฏะบ ะฟัะฐััั HAL
- [ ] ะะฝัััะฐะปัะทะฐััั ะฟะตัะธัะตััั
- [ ] Callback ััะฝะบััั
- [ ] DMA (ะฟััะผะธะน ะดะพัััะฟ ะดะพ ะฟะฐะผ'ััั)

### 4. ะัะฐะบัะธัะฝั ะฟัะพะตะบัะธ

- [ ] โ ะะปะธะผะฐะฝะฝั LED (ะณะพัะพะฒะพ!)
- [ ] ะะฝะพะฟะบะฐ + ะฟะตัะตัะธะฒะฐะฝะฝั
- [ ] PWM (ัะตะณัะปัะฒะฐะฝะฝั ััะบัะฐะฒะพััั LED)
- [ ] UART (ะทะฒ'ัะทะพะบ ะท ะบะพะผะฟ'ััะตัะพะผ)
- [ ] ADC (ัะธัะฐะฝะฝั ะดะฐััะธะบัะฒ)
- [ ] I2C/SPI (ะทะฒ'ัะทะพะบ ะท ะผะพะดัะปัะผะธ)

---

## ๐ ะะพัะธัะฝั ัะตััััะธ

### ะััััะนะฝะฐ ะดะพะบัะผะตะฝัะฐััั ST

1. **Reference Manual** - ะฟะพะฒะฝะธะน ะพะฟะธั ะฒััั ัะตะณัััััะฒ
   - [STM32F411 RM0383](https://www.st.com/resource/en/reference_manual/dm00119316-stm32f411xc-e-advanced-arm-based-32-bit-mcus-stmicroelectronics.pdf)

2. **HAL User Manual** - ะดะพะบัะผะตะฝัะฐััั ะฟะพ HAL ััะฝะบัััั
   - [UM1725](https://www.st.com/resource/en/user_manual/um1725-description-of-stm32f4-hal-and-lowlayer-drivers-stmicroelectronics.pdf)

3. **Datasheet** - ัะฐัะฐะบัะตัะธััะธะบะธ ะผัะบัะพะบะพะฝััะพะปะตัะฐ
   - [STM32F411xC/xE](https://www.st.com/resource/en/datasheet/stm32f411ce.pdf)

### YouTube ะบะฐะฝะฐะปะธ (ัะบัะฐัะฝััะบะพั/ัะพััะนััะบะพั)

- **ITVDN** - ะบัััะธ ะฟะพ embedded
- **Omega Lab** - STM32 ัััะพััะฐะปะธ
- **Mikhail Baranov** - ะฟัะพะณัะฐะผัะฒะฐะฝะฝั STM32

### YouTube ะบะฐะฝะฐะปะธ (ะฐะฝะณะปัะนััะบะพั)

- **Controller Tech**
- **DigiKey**
- **Phil's Lab**

### ะกะฟัะปัะฝะพัะธ

- [STM32 Forum](https://community.st.com/)
- Reddit: r/stm32
- Telegram: STM32 ัะฟัะปัะฝะพัะธ

---

## ๐ก ะะพัะฐะดะธ ะฝะพะฒะฐัะบะฐะผ

### โ DO (ะะพะฑััั)

- ะงะธัะฐะนัะต ะดะพะบัะผะตะฝัะฐััั
- ะะบัะฟะตัะธะผะตะฝััะนัะต ะท ะฟัะธะบะปะฐะดะฐะผะธ
- ะะธะบะพัะธััะพะฒัะนัะต debugger
- ะะฐะฟะธััะนัะต ะฒ ัะฟัะปัะฝะพัะฐั

### โ DON'T (ะะต ัะพะฑััั)

- ะะต ะบะพะฟััะนัะต ะบะพะด ะฑะตะท ัะพะทัะผัะฝะฝั
- ะะต ัะณะฝะพััะนัะต ะฟะพะฟะตัะตะดะถะตะฝะฝั ะบะพะผะฟัะปััะพัะฐ
- ะะต ะฟัะดะบะปััะฐะนัะต ะฟะตัะธัะตััั ะฑะตะท ััะตะผะธ
- ะะต ะฒะธะบะพัะธััะพะฒัะนัะต ะทะฐััะธะผะบะธ ะทะฐะผัััั ัะฐะนะผะตััะฒ (ะดะปั ัะตัะนะพะทะฝะธั ะฟัะพะตะบััะฒ)

### ๐ง ะะฝััััะผะตะฝัะธ

- **PlatformIO** - ัะตัะตะดะพะฒะธัะต ัะพะทัะพะฑะบะธ
- **STM32CubeMX** - ะณะตะฝะตัะฐัะพั ะบะพะดั (ะณัะฐัััะฝะต ะฝะฐะปะฐัััะฒะฐะฝะฝั)
- **ST-Link V2** - ะฟัะพะณัะฐะผะฐัะพั/ะดะตะฑะฐะณะตั
- **Logic Analyzer** - ะฐะฝะฐะปัะท ัะธะณะฝะฐะปัะฒ

---

## โ ะงะฐััั ะฟะธัะฐะฝะฝั

### Q: ะงะพะผั ะฝะต ะฒะธะบะพัะธััะพะฒัะฒะฐัะธ Arduino?

**A:** STM32 ะฟะพััะถะฝััะธะน (100 ะะั vs 16 ะะั), ะผะฐั ะฑัะปััะต ะฟะตัะธัะตััั (UART, SPI, I2C, USB, ADC, DAC, ัะฐะนะผะตัะธ), ะฐะปะต ัะบะปะฐะดะฝััะธะน ั ะฝะฐะปะฐัััะฒะฐะฝะฝั.

### Q: ะฉะพ ะบัะฐัะต: HAL ัะธ Register?

**A:** ะะปั ะฝะพะฒะฐัะบัะฒ - HAL. ะะปั ะพะฟัะธะผัะทะฐััั ัะฐ ะฟะพะฒะฝะพะณะพ ะบะพะฝััะพะปั - ัะตะณััััะธ.

### Q: ะงะพะผั ะฟัะพะตะบั ะฝะต ะทะฐะฒะฐะฝัะฐะถัััััั ะฝะฐ ะฟะปะฐัั?

**A:** ะะตัะตะฒัััะต:

- ST-Link ะฟัะดะบะปััะตะฝะธะน
- ะัะฐะนะฒะตัะธ ะฒััะฐะฝะพะฒะปะตะฝั
- ะะปะฐัะฐ ะพััะธะผัั ะถะธะฒะปะตะฝะฝั
- ะัะฐะฒะธะปัะฝะพ ะฒะธะฑัะฐะฝะธะน ะฟัะพะณัะฐะผะฐัะพั ะฒ platformio.ini

### Q: ะฏะบ ะดะตะฑะฐะถะธัะธ ะฟัะพะณัะฐะผั?

**A:** PlatformIO ะผะฐั ะฒะฑัะดะพะฒะฐะฝะธะน debugger. ะะฐัะธัะฝััั F5 ะฐะฑะพ Debug โ Start Debugging.

---

**ะฃัะฟัััะฒ ั ะฒะธะฒัะตะฝะฝั STM32! ๐**

*ะฆะตะน ัะฐะนะป ััะฒะพัะตะฝะพ ัะบ ัะฐััะธะฝะฐ ะฝะฐะฒัะฐะปัะฝะพะณะพ ะฟัะพะตะบัั ะดะปั ัะพะทัะผัะฝะฝั ััััะบัััะธ STM32 ะฟัะพะตะบััะฒ ะฝะฐ PlatformIO ะท HAL.*
